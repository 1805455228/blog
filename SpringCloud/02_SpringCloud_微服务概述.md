---
title: 02_SpringCloud_微服务概述
date: 2019-12-02 22:44:57
tags: 
 - SpringCloud
categories:
 - SpringCloud
---

# 02_SpringCloud_微服务概述

## 微服务是什么？

[马丁福勒](https://martinfowler.com/articles/microservices.html)（微服务提出者）这样描述微服务：

- 就目前而言，对于微服务业界并没有一个统一的、标准的定义；

- 但通常而言，微服务架构是一种架构模式或者说是一种架构风格，**它提供将单一应用程序划分为一组小的服务**，每个服务运行在其独立的自己的**进程中**，服务之间互相协调、互相配合，为用户提供最终价值。

- 服务之间采用轻量级的通信机制互相沟通（通常是HTTP的RESTful API）。

- 每个服务都围绕着具体业务进行构建，并且能够被独立的部署到生产环境、类生产环境等；

- 另外，应尽量避免统一的、集中式的服务管理机制，对具体的一个服务而言，应根据业务上下文，选择合适的语言、工具对其进行构建，可以有一个非常轻量级的集中式管理来协调这些服务，可以使用不同的语言来编写服务，也可以使用不同的数据存储；



技术维度理解：

微服务化的核心就是将传统的一站式应用，根据业务拆分一个一个的服务，彻底地去耦合，每一个微服务提供单个业务功能的服务，一个服务做一件事，从技术角度看就是一种小而独立的处理过程，类似进程的概念，能够自行单独启动或销毁，拥有自己独立的数据库；



特点：

- 拆分各个模块、服务
- 各自独立的进程



## 微服务与微服务架构

### 微服务

强调的是服务的大小，关注的是某一个点，是具体解决某一个问题/提供落地对应服务的一个服务应用。狭义的看，可以看做Eclipse里面的一个一个微服务工程/或者Module；一个模块就做一件事情；



### 微服务架构

马丁福勒说：微服务架构主要关注于开发一种单一的应用，每一个微小的服务都拥有自己的进程，他们之间用一种轻量级的沟通联系起来，通常是HTTP的API资源，他们可以做独立的部署；



- **微服务架构是一种架构模式**，它提供将单一应用程序划分为一组小的服务，服务之间互相协调、互相配合，为用户提供最终价值。
- **每个服务运行在独立的进程中**，服务与服务之间采用轻量级的通信机制互相协作（通常是基于HTTP协议的RESTful API）。
- 每个服务都围绕着具体业务进行构建，并且能够被独立的部署到生产环境、类生产环境等。
- 另外，**应当尽量避免同一的、集中式的服务管理机制**，对具体的一个服务而言，应根据业务上下文，选择合适的语言、工具对其进行构建；



## 微服务的优缺点

### 优点

- 每个服务足够内聚，足够小，代码容易理解，这样能聚焦一个指定的业务功能或业务需求；
- 开发简单、开发效率提高，一个服务可能就是专一的只干一件事；
- 微服务能够被小团队单独开发，这个小团队可以是2到5个人的开发人员组成；
- 微服务是松耦合的，是有功能意义的服务，无论是在开发阶段或部署阶段都是独立的；
- 微服务能够使用不同的语言开发；
- 易于和第三方集成，微服务允许容易且灵活的方式集成自动部署，通过持续集成工具，如Jenkins,Hudson,bamboo。
- 微服务易于被一个开发人员理解，修改和维护。这样的小团队能够更关注自己的工作成果，无需通过合作才能体现价值；
- 微服务允许你利用融合最新的技术。
- **微服务只是业务逻辑的代码，不会和HTML和CSS等其他界面的组件混合**；
- **每个微服务都有自己的存储能力，可以有自己的数据库，也可以有统一的数据库**；（灵活搭配，单独的库、公共的库）

### 缺点

- 开发人员要处理分布式系统的复杂性；
- 多服务运维难度，随着服务的增加，运维的压力也增大；
- 系统部署依赖；
- 服务间的通信成本；
- 数据一致性；
- 系统集成测试；
- 性能监控；



## 微服务的技术栈有哪些？

分布式的微服务架构所需要的维度：

- 服务治理

- 服务注册

- 服务调用
- 服务负载均衡
- 服务监控

| 微服务条目                               | 落地技术                                                     |
| ---------------------------------------- | ------------------------------------------------------------ |
| 服务开发                                 | SpringBoot、Spring、SpringMVC等                              |
| 服务配置与管理                           | Netflix公司的Archaius、阿里的Diamond等                       |
| 服务注册与发现                           | Eureka、Consul、Zookeeper等                                  |
| 服务调用                                 | Rest、RPC、gRPC                                              |
| 服务熔断器                               | Hystrix、Envoy等                                             |
| 负载均衡                                 | Ribbon、Nginx等                                              |
| 服务接口调用（客户端调用服务的简化工具） | Feign等                                                      |
| 消息队列                                 | Kafka、RabbitMQ、ActiveMQ等                                  |
| 服务配置中心管理                         | SpringCloudConfig、Chef等                                    |
| 服务路由（API网关）                      | Zuul等                                                       |
| 服务监控                                 | Zabbix、Nagios、Metrics、Spectator等                         |
| 全链路追踪                               | Zipkin、Brave、Dapper等                                      |
| 服务部署                                 | Docker、OpenStack、Kubernetes等                              |
| 数据流操作开发包                         | SpringCloud Stream（封装与Redis、Rabbit、Kafka等发送接收消息） |
| 事件消息总栈                             | SpringCloud Bus                                              |



## 为什么选择SpringCloud作为微服务架构

### 选型依据

- 整体解决方案和框架成熟度
- 社区热度
- 可维护性
- 学习曲线



### 当前各大IT公司用的微服务架构有哪些？

- 阿里Dubbo/HSF
- 京东JSF
- 新浪微博Motan
- 当当网DubboX



### 各微服务框架对比

| 功能           | Netflix/SpringCloud                                          | Montan                                                       | gRPC                      | Thrift   | Dubbo/DubboX                               |
| -------------- | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------- | -------- | ------------------------------------------ |
| 功能定位       | 完整的微服务框架                                             | RPC框架，但整合了ZK或Consul，实现集群环境的基本服务注册/发现 | RPC框架                   | RPC框架  | 服务框架                                   |
| 支持REST       | 是（Ribbon支持多种可插拔的序列化选择）                       | 否                                                           | 否                        | 否       | 否                                         |
| 支持RPC        | 否                                                           | 是（Hession2）                                               | 是                        | 是       | 是                                         |
| 支持多语言     | 是（RESTful风格即可）                                        | 否                                                           | 是                        | 是       | 否                                         |
| 服务注册/发现  | 是（Eureka）Eureka服务注册表，Karyon服务端框架支持服务自注册和健康检查 | 是（zookeeper/consul)                                        | 否                        | 否       | 是                                         |
| 负载均衡       | 是（服务端zuul+客户端Ribbon）<br />Zuul服务——动态路由<br />远端负载均衡Eureka（针对中间层服务器） | 是（客户端）                                                 | 否                        | 否       | 是（客户端）                               |
| 配置服务       | Netflix Archaius SpringCloud Config Server集中配置           | 是（zookeeper提供）                                          | 否                        | 否       | 是（新版的zookeeper提供，旧版不支持）      |
| 服务调用链监控 | 是（zuul）Zuul提供边缘服务，API网关                          | 否                                                           | 否                        | 否       | 否                                         |
| 高可用/容错    | 是（服务端Hystrix+客户端Ribbon）                             | 是（客户端）                                                 | 否                        | 否       | 是（客户端）                               |
| 典型应用案例   | Netflix                                                      | Sina                                                         | Google                    | FaceBook |                                            |
| 社区活跃程度   | 高                                                           | 一般                                                         | 高                        | 一般     | 停更过一段时间，后被Apache收为顶级项目维护 |
| 学习难度       | 中等                                                         | 低                                                           | 高                        | 高       | 低                                         |
| 文档丰富度     | 高                                                           | 一般                                                         | 一般                      | 一般     | 高                                         |
| 其他           | SpringCloud Bus为我们的应用程序带来了更多管理端点            | 支持降级                                                     | Netflix内部在开发集成gRPC | IDL定义  | 实践的公司比较多                           |











